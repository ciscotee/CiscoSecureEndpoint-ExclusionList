{
  "workflow": {
    "unique_name": "definition_workflow_02DZR62DUP11O0cNvaANO57riG6vx1VVzwB",
    "name": "Secure_Endpoint_Exclusion_List",
    "title": "Secure_Endpoint_Exclusion_List",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "output",
          "name": "SecureEndpoint_Exclusion_Set",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_02DZR62ED8TCU735k12FiLT4pj16c5crXmO",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "tabletype_02DZNZVP7M8KI2uGj5wflJ6S6vkhaO4N51c",
        "properties": {
          "scope": "output",
          "name": "Exclusion_Set_Table",
          "type": "datatype.table",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_02DZR62ED9HU06s3h5YuE2LyuIbzd1zJFsD",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Secure_Endpoint_OrgID",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_02DZR62ED97OG5iNk3yhRaapHMDfwdua2DL",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "0",
          "scope": "input",
          "name": "_start",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_02DZR62ED90MY2kLykPr4waYa80cX5T10tl",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "HTTP_STATUS",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_02E08MPV66FNH0aTBue5ck4RUQ6gAqKHPhz",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.secure_string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Access_Token",
          "type": "datatype.secure_string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_02DZR62ED880T7T8YvkgpORiqhTXJXVIRlC",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "description": "List exclusion and export for validation",
      "display_name": "Secure_Endpoint_Exclusion_List",
      "runtime_user": {
        "target_default": true
      },
      "target": {
        "execute_on_target_group": true,
        "target_group": {
          "target_group_id": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
          "run_on_all_targets": false,
          "selected_target_types": [
            "web-service.endpoint"
          ],
          "use_criteria": {
            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
            "conditions": [
              {
                "operator": "eq",
                "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                "right_operand": "Secure_Endpoint_V3"
              }
            ]
          }
        }
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_02DZR62JNDYEP4xPF1u5XHNYkmpwKILlOlG",
        "name": "Set Variables",
        "title": "Update_Variable",
        "type": "core.set_multiple_variables",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Update_Variable",
          "skip_execution": false,
          "variables_to_update": [
            {
              "variable_to_update": "$workflow.definition_workflow_02DZR62DUP11O0cNvaANO57riG6vx1VVzwB.local.variable_workflow_02DZR62ED97OG5iNk3yhRaapHMDfwdua2DL$",
              "variable_value_new": "$env.variable_02DE6YRNRBCB57XL51FTUqGVHFbAorx2SWA.env.variable_02DE6YRNRBCB57XL51FTUqGVHFbAorx2SWA$"
            }
          ]
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02E1ZOF3DMXNM0PfQ2MQSl0APWDVxPrsPAz",
        "name": "Group",
        "title": "Get Access Token",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Get Access Token",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_02DZR62L2SHJ41xIXDGxONzIhtPMDyZBbf1",
            "name": "Group",
            "title": "XDR_Token_Request",
            "type": "logic.group",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "XDR_Token_Request",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02DZR62NPY9NR2a8gVyc6uNXmGyrCGG5QoZ",
                "name": "XDR - Generate Access Token",
                "title": "XDR - Generate Access Token",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "XDR - Generate Access Token",
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target": true,
                    "target_id": "definition_target_01OLZWAJLAZB66FxVX2zRLTqQqMVxgmnri5",
                    "target_type": "web-service.endpoint"
                  },
                  "workflow_id": "definition_workflow_02DDIR6ATE1L579banVg6VWl8rgQDCX8ErV",
                  "workflow_name": "XDR - Generate Access Token"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02DZR62PAJ6F83kp4add6bRNaXrPVVmKoqI",
                "name": "Execute Python Script",
                "title": "Build the Authorization Header",
                "type": "python3.script",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Build the Authorization Header",
                  "script": "import sys\n\naccessToken = sys.argv[1]\nhasToken = True if len(accessToken) \u003e 0 else False\n\nheaderName = 'Authorization'\nheaderValue = 'Bearer ' + accessToken\n\nif not hasToken:\n  headerName = ''\n  headerValue = ''",
                  "script_arguments": [
                    "$activity.definition_activity_02DZR62NPY9NR2a8gVyc6uNXmGyrCGG5QoZ.output.variable_workflow_02DDJ705ASQRU4waEjw21fJwaXKbLjIg9p9$",
                    ""
                  ],
                  "script_queries": [
                    {
                      "script_query": "headerName",
                      "script_query_name": "headerName",
                      "script_query_type": "secure_string"
                    },
                    {
                      "script_query": "headerValue",
                      "script_query_name": "headerValue",
                      "script_query_type": "secure_string"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_02DZR62QNMOMD0Wms4F0SUYuythe6rfzszy",
            "name": "Group",
            "title": "Secure_Endpoint_Token_Request",
            "type": "logic.group",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Secure_Endpoint_Token_Request",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02DZR62T5YR051YXUcHDnK3w137hoTQxxaK",
                "name": "HTTP Request",
                "title": "SecureEndpoint_Request_Access",
                "type": "web-service.http_request",
                "base_type": "activity",
                "properties": {
                  "accept": "application/json",
                  "action_timeout": 180,
                  "allow_auto_redirect": true,
                  "allow_headers_redirect": false,
                  "body": "grant_type=client_credentials",
                  "continue_on_error_status_code": false,
                  "continue_on_failure": false,
                  "custom_headers": [
                    {
                      "name": "Content-Type",
                      "value": "application/x-www-form-urlencoded"
                    },
                    {
                      "name": "$activity.definition_activity_02DZR62PAJ6F83kp4add6bRNaXrPVVmKoqI.output.script_queries.headerName$",
                      "value": "$activity.definition_activity_02DZR62PAJ6F83kp4add6bRNaXrPVVmKoqI.output.script_queries.headerValue$"
                    }
                  ],
                  "display_name": "SecureEndpoint_Request_Access",
                  "method": "POST",
                  "relative_url": "/access_tokens",
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target": true,
                    "target_id": "definition_target_02DDG6868VHDM2usFCivxpeXr1QlQmHBm5N"
                  }
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02DZR62UUJ1OG2KDatvzmRbTh7CFZfZ03sX",
                "name": "JSONPath Query",
                "title": "Extract_Secure_Endpoint_Token",
                "type": "corejava.jsonpathquery",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Extract_Secure_Endpoint_Token",
                  "input_json": "$activity.definition_activity_02DZR62T5YR051YXUcHDnK3w137hoTQxxaK.output.response_body$",
                  "jsonpath_queries": [
                    {
                      "jsonpath_query": "$.access_token",
                      "jsonpath_query_name": "access_token",
                      "jsonpath_query_type": "secure_string"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02DZR62W6PPU925YkMTFMWLmMcamVW1SJDh",
                "name": "Set Variables",
                "title": "Update_Secure_Endpoint_Token",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Update_Secure_Endpoint_Token",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_02DZR62DUP11O0cNvaANO57riG6vx1VVzwB.local.variable_workflow_02DZR62ED880T7T8YvkgpORiqhTXJXVIRlC$",
                      "variable_value_new": "$activity.definition_activity_02DZR62UUJ1OG2KDatvzmRbTh7CFZfZ03sX.output.jsonpath_queries.access_token$"
                    },
                    {
                      "variable_to_update": "$workflow.definition_workflow_02DZR62DUP11O0cNvaANO57riG6vx1VVzwB.local.variable_workflow_02E08MPV66FNH0aTBue5ck4RUQ6gAqKHPhz$",
                      "variable_value_new": "$activity.definition_activity_02DZR62T5YR051YXUcHDnK3w137hoTQxxaK.output.status_code$"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_02E2D97M34OLJ4kadofTjDfLvsCddVA4G5F",
        "name": "Group",
        "title": "Validation Status and ORG ID",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Validation Status and ORG ID",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_02E08Q85HWVM45ShLsZBSB7KH6kGbBWi4W3",
            "name": "Condition Block",
            "title": "Check STATUS",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Check STATUS",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_02E08Q863WJF12AQxirkvQPztEJd7nC98Zp",
                "name": "Condition Branch",
                "title": "200 OK",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_02DZR62T5YR051YXUcHDnK3w137hoTQxxaK.output.status_code$",
                    "operator": "eq",
                    "right_operand": 200
                  },
                  "continue_on_failure": false,
                  "display_name": "200 OK",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02E08Q86KWA9G0EoO8KWEH0EvUAHNvr2nzG",
                "name": "Condition Branch",
                "title": "Other",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_02DZR62T5YR051YXUcHDnK3w137hoTQxxaK.output.status_code$",
                    "operator": "ne",
                    "right_operand": 200
                  },
                  "continue_on_failure": false,
                  "display_name": "Other",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_02E08SJ5BLL5K0dQr37poNqYf8OmUWrSiye",
                    "name": "Completed",
                    "title": "Completed",
                    "type": "logic.completed",
                    "base_type": "activity",
                    "properties": {
                      "completion_type": "succeeded",
                      "continue_on_failure": false,
                      "display_name": "Completed",
                      "result_message": "HTTP_ERROR",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_02E08VUQM84D47Zkx64TFdoatDvbSddl7Yj",
            "name": "Condition Block",
            "title": "Check ORG ID",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Check ORG ID",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_02E08VUR3HEOW3k8bndWsS7XqP8QDRKIfsK",
                "name": "Condition Branch",
                "title": "ORG ID OK",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$env.variable_02DE6YRNRBCB57XL51FTUqGVHFbAorx2SWA.env.variable_02DE6YRNRBCB57XL51FTUqGVHFbAorx2SWA$",
                    "operator": "ne",
                    "right_operand": "0"
                  },
                  "continue_on_failure": false,
                  "display_name": "ORG ID OK",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02E08VURLJBEP7CwQI4cHAkloXb0Jsn1r3R",
                "name": "Condition Branch",
                "title": "Do not have ORG ID",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$env.variable_02DE6YRNRBCB57XL51FTUqGVHFbAorx2SWA.env.variable_02DE6YRNRBCB57XL51FTUqGVHFbAorx2SWA$",
                    "operator": "eq",
                    "right_operand": "0"
                  },
                  "continue_on_failure": false,
                  "display_name": "Do not have ORG ID",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_02E091QDYY2HU7BAm2NeuruvQLhp5hxa0SK",
                    "name": "HTTP Request",
                    "title": "Request ORG ID",
                    "type": "web-service.http_request",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "allow_auto_redirect": true,
                      "allow_headers_redirect": false,
                      "continue_on_error_status_code": false,
                      "continue_on_failure": false,
                      "custom_headers": [
                        {
                          "name": "Authorization",
                          "value": "Bearer $workflow.definition_workflow_02DZR62DUP11O0cNvaANO57riG6vx1VVzwB.local.variable_workflow_02DZR62ED880T7T8YvkgpORiqhTXJXVIRlC$"
                        }
                      ],
                      "display_name": "Request ORG ID",
                      "method": "GET",
                      "relative_url": "/organizations?size=10",
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target": true,
                        "target_id": "definition_target_02DDG6868VHDM2usFCivxpeXr1QlQmHBm5N"
                      }
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_02E09564ECXIW0LTUfTmcJlevLyzXqkqG2R",
                    "name": "JSONPath Query",
                    "title": "Extract ORG ID",
                    "type": "corejava.jsonpathquery",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": false,
                      "display_name": "Extract ORG ID",
                      "input_json": "$activity.definition_activity_02E091QDYY2HU7BAm2NeuruvQLhp5hxa0SK.output.response_body$",
                      "jsonpath_queries": [
                        {
                          "jsonpath_query": "$..organizationIdentifier",
                          "jsonpath_query_name": "ORG_ID",
                          "jsonpath_query_type": "string",
                          "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_02E096MVANF4U619uLK83v5qm6yZYR5l9KR",
                    "name": "Set Variables",
                    "title": "Update ORG ID to variable",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Update ORG ID to variable",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$env.variable_02DE6YRNRBCB57XL51FTUqGVHFbAorx2SWA.env.variable_02DE6YRNRBCB57XL51FTUqGVHFbAorx2SWA$",
                          "variable_value_new": "$activity.definition_activity_02E09564ECXIW0LTUfTmcJlevLyzXqkqG2R.output.jsonpath_queries.ORG_ID$"
                        },
                        {
                          "variable_to_update": "$workflow.definition_workflow_02DZR62DUP11O0cNvaANO57riG6vx1VVzwB.local.variable_workflow_02DZR62ED97OG5iNk3yhRaapHMDfwdua2DL$",
                          "variable_value_new": "$activity.definition_activity_02E09564ECXIW0LTUfTmcJlevLyzXqkqG2R.output.jsonpath_queries.ORG_ID$"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_02E2D9P7PXG314TWXBjVBNOEwzaGUzD8iZD",
        "name": "Group",
        "title": "Query Exclusion Set",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "description": "Query How many Exclusion set available",
          "display_name": "Query Exclusion Set",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_02DZR62XNH42F066nkeX6P92nagsBLaxWs3",
            "name": "HTTP Request",
            "title": "Query Exclusion Set",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "continue_on_error_status_code": false,
              "continue_on_failure": false,
              "custom_headers": [
                {
                  "name": "Authorization",
                  "value": "Bearer $workflow.definition_workflow_02DZR62DUP11O0cNvaANO57riG6vx1VVzwB.local.variable_workflow_02DZR62ED880T7T8YvkgpORiqhTXJXVIRlC$"
                }
              ],
              "display_name": "Query Exclusion Set",
              "method": "GET",
              "relative_url": "/organizations/$workflow.definition_workflow_02DZR62DUP11O0cNvaANO57riG6vx1VVzwB.local.variable_workflow_02DZR62ED97OG5iNk3yhRaapHMDfwdua2DL$/exclusion_sets?size=100",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target": true,
                "target_id": "definition_target_02DDG6868VHDM2usFCivxpeXr1QlQmHBm5N"
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02E072XI8VZPF2cIkvDzx46jfqhYaLjIIi2",
            "name": "Parallel Block",
            "title": "flattened_exclusion_set",
            "type": "logic.parallel",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "flattened_exclusion_set",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_02E072XJHB30I0AGqkf4VfC8L9RrB4QibUy",
                "name": "Parallel Branch",
                "title": "Set I",
                "type": "logic.parallel_block",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set I",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_02DZR6355SO5X2uCLLQqRxBHuXS95bjdwlx",
                    "name": "Set Variables",
                    "title": "Set Variables",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Set Variables",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_02DZR62DUP11O0cNvaANO57riG6vx1VVzwB.output.variable_workflow_02DZR62ED8TCU735k12FiLT4pj16c5crXmO$",
                          "variable_value_new": "$activity.definition_activity_02DZR62XNH42F066nkeX6P92nagsBLaxWs3.output.response_body$"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_02E072XK0ZPCO1RXv7GOCWcMm4nC8OFTXjf",
                "name": "Parallel Branch",
                "title": "Set II",
                "type": "logic.parallel_block",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set II",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_02E07312CZDOT6UKs3WW4EZJZSw4heSVrLq",
                    "name": "Execute Python Script",
                    "title": "Execute Python Script",
                    "type": "python3.script",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": false,
                      "display_name": "Execute Python Script",
                      "script": "import json\nimport sys\n\n# Parse the JSON string into a Python dictionary\njson_data = json.loads(sys.argv[1])\n# List to hold all the flattened data\nflattened_data = []\n\n# Loop through each item in 'data'\nfor item in json_data['data']:\n    # Start with a flat dictionary containing 'guid' and 'exclusionType'\n    flat_item = {\n        \"guid\": item.get('guid', ''),\n        \"operatingSystem\": item.get('operatingSystem', '')\n    }\n    \n    # Flatten 'engineSettings' if it exists\n    if 'properties' in item and isinstance(item['properties'], dict):\n        for prop_key, prop_value in item['properties'].items():\n            flat_item[f\"properties_{prop_key}\"] = prop_value\n    \n    # Add the flat_item to the list of flattened data\n    flattened_data.append(flat_item)\n\n# Now flattened_data contains the list with all data at the same level\n# You can now use flattened_data as needed in your code, for example:\n#print(json.dumps(flattened_data, indent=2))\nflattened_data = json.dumps(flattened_data)",
                      "script_arguments": [
                        "$activity.definition_activity_02DZR62XNH42F066nkeX6P92nagsBLaxWs3.output.response_body$"
                      ],
                      "script_queries": [
                        {
                          "script_query": "flattened_data",
                          "script_query_name": "flattened_data",
                          "script_query_type": "string"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_02DZR632JEAMJ6ffLsbIIu5V2CJY3PNo8fn",
            "name": "Read Table from JSON",
            "title": "Exclusion Set Table",
            "type": "corejava.read_table_from_json",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Exclusion Set Table",
              "input_json": "$activity.definition_activity_02E07312CZDOT6UKs3WW4EZJZSw4heSVrLq.output.script_queries.flattened_data$",
              "jsonpath_query": "$.",
              "persist_output": true,
              "populate_columns": false,
              "skip_execution": false,
              "table_columns": [
                {
                  "column_name": "guid",
                  "column_type": "string"
                },
                {
                  "column_name": "operatingSystem",
                  "column_type": "string"
                },
                {
                  "column_name": "properties_name",
                  "column_type": "string"
                }
              ]
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02DZR636K59S06mFxaOn1kUoeuzQoXcoPXj",
            "name": "For Each",
            "title": "Update Exclusion Set to Table",
            "type": "logic.for_each",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Update Exclusion Set to Table",
              "skip_execution": false,
              "source_array": "$activity.definition_activity_02DZR632JEAMJ6ffLsbIIu5V2CJY3PNo8fn.output.read_table_from_json$"
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02DZR63BTDAOF2GnnBs0GA1W0jsVCFK1ecb",
                "name": "Add Row to Table",
                "title": "Add Row to Table Exclusion Set",
                "type": "core.addrowtotable",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Add Row to Table Exclusion Set",
                  "input_table": "$workflow.definition_workflow_02DZR62DUP11O0cNvaANO57riG6vx1VVzwB.output.variable_workflow_02DZR62ED9HU06s3h5YuE2LyuIbzd1zJFsD$",
                  "row": [
                    {
                      "key": "guid",
                      "type": "string",
                      "value": "$activity.definition_activity_02DZR636K59S06mFxaOn1kUoeuzQoXcoPXj.input.source_array[@].guid$"
                    },
                    {
                      "key": "name",
                      "type": "string",
                      "value": "$activity.definition_activity_02DZR636K59S06mFxaOn1kUoeuzQoXcoPXj.input.source_array[@].properties_name$"
                    },
                    {
                      "key": "operatingsystem",
                      "type": "string",
                      "value": "$activity.definition_activity_02DZR636K59S06mFxaOn1kUoeuzQoXcoPXj.input.source_array[@].operatingSystem$"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_02E2DARRYHABK0xTfKWt3JM8eMj7aXbCz2H",
        "name": "Group",
        "title": "Query Exclusion Set Details",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "description": "Query Exclusion Set details available ",
          "display_name": "Query Exclusion Set Details",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_02DZR645U3UQ93bIjM3qwop9lhkcoTE24Cu",
            "name": "For Each",
            "title": "Extract Exclusion Set Details",
            "type": "logic.for_each",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Extract Exclusion Set Details",
              "skip_execution": false,
              "source_array": "$workflow.definition_workflow_02DZR62DUP11O0cNvaANO57riG6vx1VVzwB.output.variable_workflow_02DZR62ED9HU06s3h5YuE2LyuIbzd1zJFsD$"
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02DZR64A4XWK25NmSxGGR63Lxld2sNrfX9y",
                "name": "HTTP Request",
                "title": "Query Exclusion Set Details",
                "type": "web-service.http_request",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "allow_auto_redirect": true,
                  "allow_headers_redirect": false,
                  "continue_on_error_status_code": false,
                  "continue_on_failure": false,
                  "custom_headers": [
                    {
                      "name": "Authorization",
                      "value": "Bearer $workflow.definition_workflow_02DZR62DUP11O0cNvaANO57riG6vx1VVzwB.local.variable_workflow_02DZR62ED880T7T8YvkgpORiqhTXJXVIRlC$"
                    }
                  ],
                  "display_name": "Query Exclusion Set Details",
                  "method": "GET",
                  "relative_url": "/organizations/$workflow.definition_workflow_02DZR62DUP11O0cNvaANO57riG6vx1VVzwB.local.variable_workflow_02DZR62ED97OG5iNk3yhRaapHMDfwdua2DL$/exclusion_sets/$activity.definition_activity_02DZR645U3UQ93bIjM3qwop9lhkcoTE24Cu.input.source_array[@].guid$/exclusions?size=100\u0026start=$workflow.definition_workflow_02DZR62DUP11O0cNvaANO57riG6vx1VVzwB.input.variable_workflow_02DZR62ED90MY2kLykPr4waYa80cX5T10tl$",
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target": true,
                    "target_id": "definition_target_02DDG6868VHDM2usFCivxpeXr1QlQmHBm5N"
                  }
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02DZT9ACCOI6A6hCH0NT9qhLuBETIN6DAXT",
                "name": "Execute Python Script",
                "title": "Execute Python Script transform data",
                "type": "python3.script",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": true,
                  "display_name": "Execute Python Script transform data",
                  "script": "import json\nimport sys\n\n# Parse the JSON string into a Python dictionary\njson_data = json.loads(sys.argv[1])\n# List to hold all the flattened data\nflattened_data = []\n\n# Loop through each item in 'data'\nfor item in json_data['data']:\n    # Start with a flat dictionary containing 'guid' and 'exclusionType'\n    flat_item = {\n        \"guid\": item.get('guid', ''),\n        \"exclusionType\": item.get('exclusionType', '')\n    }\n    \n    # Flatten 'engineSettings' if it exists\n    if 'engineSettings' in item:\n        for setting, details in item['engineSettings'].items():\n            flat_item[f\"engineSettings_{setting}_applyToEngine\"] = details.get('applyToEngine', False)\n            # Special case for 'fileScan' to include 'applyToChildProcesses'\n            if setting == 'fileScan':\n                flat_item[f\"engineSettings_{setting}_applyToChildProcesses\"] = details.get('applyToChildProcesses', False)\n    \n    # Add other fields from the item, if needed\n    for key in item:\n        if key not in ('guid', 'exclusionType', 'engineSettings'):\n            if isinstance(item[key], dict):\n                # Flatten nested dictionaries\n                for subkey, value in item[key].items():\n                    flat_item[f\"{key}_{subkey}\"] = value\n            else:\n                flat_item[key] = item[key]\n    \n    # Add the flat_item to the list of flattened data\n    flattened_data.append(flat_item)\n\n# Now flattened_data contains the list with all data at the same level\n# You can now use flattened_data as needed in your code, for example:\n#print(json.dumps(flattened_data, indent=2))\nflattened_data = json.dumps(flattened_data)",
                  "script_arguments": [
                    "$activity.definition_activity_02DZR64A4XWK25NmSxGGR63Lxld2sNrfX9y.output.response_body$"
                  ],
                  "script_queries": [
                    {
                      "script_query": "flattened_data",
                      "script_query_name": "exclusiondetails",
                      "script_query_type": "string"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02DZSLW6QG3J23eEheTxCEVDeDafWwf9V8g",
                "name": "Read Table from JSON",
                "title": "Read Table from JSON",
                "type": "corejava.read_table_from_json",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "description": "Prepare data before update or add row",
                  "display_name": "Read Table from JSON",
                  "input_json": "$activity.definition_activity_02DZT9ACCOI6A6hCH0NT9qhLuBETIN6DAXT.output.script_queries.exclusiondetails$",
                  "jsonpath_query": "$.",
                  "persist_output": true,
                  "populate_columns": false,
                  "skip_execution": false,
                  "table_columns": [
                    {
                      "column_name": "guid",
                      "column_type": "string"
                    },
                    {
                      "column_name": "exclusionType",
                      "column_type": "string"
                    },
                    {
                      "column_name": "engineSettings",
                      "column_type": "string"
                    },
                    {
                      "column_name": "process",
                      "column_type": "string"
                    },
                    {
                      "column_name": "path",
                      "column_type": "string"
                    },
                    {
                      "column_name": "anydrive",
                      "column_type": "string"
                    },
                    {
                      "column_name": "executableName",
                      "column_type": "string"
                    },
                    {
                      "column_name": "excludeExploitPrevention",
                      "column_type": "string"
                    },
                    {
                      "column_name": "engineSettings_fileScan_applyToEngine",
                      "column_type": "string"
                    },
                    {
                      "column_name": "engineSettings_fileScan_applyToChildProcesses",
                      "column_type": "string"
                    },
                    {
                      "column_name": "engineSettings_maliciousActivity_applyToEngine",
                      "column_type": "string"
                    },
                    {
                      "column_name": "engineSettings_behavioralProtection_applyToEngine",
                      "column_type": "string"
                    },
                    {
                      "column_name": "engineSettings_systemProcessProtection_applyToEngine",
                      "column_type": "string"
                    },
                    {
                      "column_name": "process_path",
                      "column_type": "string"
                    },
                    {
                      "column_name": "process_sha",
                      "column_type": "string"
                    },
                    {
                      "column_name": "engineSettings_maliciousActivity_applyToChildProcesses",
                      "column_type": "string"
                    },
                    {
                      "column_name": "engineSettings_behavioralProtection_applyToChildProcesses",
                      "column_type": "string"
                    },
                    {
                      "column_name": "engineSettings_systemProcessProtection_applyToChildProcesses",
                      "column_type": "string"
                    },
                    {
                      "column_name": "process_user",
                      "column_type": "string"
                    },
                    {
                      "column_name": "fileExtension",
                      "column_type": "string"
                    },
                    {
                      "column_name": "iocGuid",
                      "column_type": "string"
                    }
                  ]
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo",
                "name": "For Each",
                "title": "Insert and Update table",
                "type": "logic.for_each",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Insert and Update table",
                  "skip_execution": false,
                  "source_array": "$activity.definition_activity_02DZSLW6QG3J23eEheTxCEVDeDafWwf9V8g.output.read_table_from_json$"
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_02E2EA4UXOVZB7973NR0bSLnKNvyWTGSf4U",
                    "name": "Select from Table",
                    "title": "Query data to validate before insert or update",
                    "type": "core.selectfromtable",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "columns": [
                        {
                          "column_name": "master_guid",
                          "column_type": "string"
                        },
                        {
                          "column_name": "set_guid",
                          "column_type": "string"
                        }
                      ],
                      "continue_on_failure": false,
                      "display_name": "Query data to validate before insert or update",
                      "input_table": "$env.variable_02E23Z4FEXZR31MN2QwPHB7JMk83G6bBMft.env.variable_02E23Z4FEXZR31MN2QwPHB7JMk83G6bBMft$",
                      "number_of_rows": {
                        "all_rows": true
                      },
                      "persist_output": true,
                      "skip_execution": false,
                      "sorting": {
                        "no_sort": true
                      },
                      "where_clause": "set_guid = '$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].guid$'"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_02E2E8MH0TF9Z6ldgmhC5vs5XTKVyAvzQSG",
                    "name": "Condition Block",
                    "title": "Check the information exist",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Check the information exist",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_02E2E8MHOG5E61QuoulHVg1DVpuOaM0mNrm",
                        "name": "Condition Branch",
                        "title": "Data not exist",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_02E2EA4UXOVZB7973NR0bSLnKNvyWTGSf4U.output.response_body$",
                            "operator": "eq",
                            "right_operand": "[]"
                          },
                          "continue_on_failure": false,
                          "display_name": "Data not exist",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_02E07QGJ0TB7R2nB797pDu9gmiv8nztgWey",
                            "name": "Add Row to Table",
                            "title": "Add Row to Table",
                            "type": "core.addrowtotable",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "continue_on_failure": false,
                              "display_name": "Add Row to Table",
                              "input_table": "$env.variable_02E23Z4FEXZR31MN2QwPHB7JMk83G6bBMft.env.variable_02E23Z4FEXZR31MN2QwPHB7JMk83G6bBMft$",
                              "row": [
                                {
                                  "key": "master_guid",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02DZR645U3UQ93bIjM3qwop9lhkcoTE24Cu.input.source_array[@].guid$"
                                },
                                {
                                  "key": "set_guid",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].guid$"
                                },
                                {
                                  "key": "exclusionType",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].exclusionType$"
                                },
                                {
                                  "key": "fileExtension",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].fileExtension$"
                                },
                                {
                                  "key": "iocGuid",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].iocGuid$"
                                },
                                {
                                  "key": "path",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].path$"
                                },
                                {
                                  "key": "anyDrive",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].anydrive$"
                                },
                                {
                                  "key": "executableName",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].executableName$"
                                },
                                {
                                  "key": "excludeExploitPrevention",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].excludeExploitPrevention$"
                                },
                                {
                                  "key": "fileScanEngine",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].engineSettings_fileScan_applyToEngine$"
                                },
                                {
                                  "key": "fileScanChild",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].engineSettings_fileScan_applyToChildProcesses$"
                                },
                                {
                                  "key": "maliciousEngine",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].engineSettings_maliciousActivity_applyToEngine$"
                                },
                                {
                                  "key": "maliciousChild",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].engineSettings_maliciousActivity_applyToChildProcesses$"
                                },
                                {
                                  "key": "behavioralEngine",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].engineSettings_behavioralProtection_applyToEngine$"
                                },
                                {
                                  "key": "behavioralChild",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].engineSettings_behavioralProtection_applyToChildProcesses$"
                                },
                                {
                                  "key": "systemEngine",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].engineSettings_systemProcessProtection_applyToEngine$"
                                },
                                {
                                  "key": "systemChild",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].engineSettings_systemProcessProtection_applyToChildProcesses$"
                                },
                                {
                                  "key": "processPath",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].process_path$"
                                },
                                {
                                  "key": "processSHA",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].process_sha$"
                                },
                                {
                                  "key": "processUser",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].process_user$"
                                }
                              ],
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_02E2E8MIDIOC61TmzOhNpGJAQnVYq2pMEpu",
                        "name": "Condition Branch",
                        "title": "Data exist",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_02E2EA4UXOVZB7973NR0bSLnKNvyWTGSf4U.output.response_body$",
                            "operator": "ne",
                            "right_operand": "[]"
                          },
                          "continue_on_failure": false,
                          "display_name": "Data exist",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_02E2DLZ2ODION5uhsHMgxnyctzKsy7gSHzo",
                            "name": "Update Row in Table",
                            "title": "Update Row in Table",
                            "type": "core.updaterowintable",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "columns": [
                                {
                                  "column_name": "master_guid",
                                  "column_type": "string"
                                },
                                {
                                  "column_name": "set_guid",
                                  "column_type": "string"
                                },
                                {
                                  "column_name": "exclusionType",
                                  "column_type": "string"
                                },
                                {
                                  "column_name": "fileExtension",
                                  "column_type": "string"
                                },
                                {
                                  "column_name": "iocGuid",
                                  "column_type": "string"
                                },
                                {
                                  "column_name": "path",
                                  "column_type": "string"
                                },
                                {
                                  "column_name": "anyDrive",
                                  "column_type": "string"
                                },
                                {
                                  "column_name": "executableName",
                                  "column_type": "string"
                                },
                                {
                                  "column_name": "excludeExploitPrevention",
                                  "column_type": "string"
                                },
                                {
                                  "column_name": "fileScanEngine",
                                  "column_type": "string"
                                },
                                {
                                  "column_name": "fileScanChild",
                                  "column_type": "string"
                                },
                                {
                                  "column_name": "maliciousEngine",
                                  "column_type": "string"
                                },
                                {
                                  "column_name": "maliciousChild",
                                  "column_type": "string"
                                },
                                {
                                  "column_name": "behavioralEngine",
                                  "column_type": "string"
                                },
                                {
                                  "column_name": "behavioralChild",
                                  "column_type": "string"
                                },
                                {
                                  "column_name": "systemEngine",
                                  "column_type": "string"
                                },
                                {
                                  "column_name": "systemChild",
                                  "column_type": "string"
                                },
                                {
                                  "column_name": "processPath",
                                  "column_type": "string"
                                },
                                {
                                  "column_name": "processSHA",
                                  "column_type": "string"
                                },
                                {
                                  "column_name": "processUser",
                                  "column_type": "string"
                                }
                              ],
                              "continue_on_failure": false,
                              "display_name": "Update Row in Table",
                              "input_table": "$env.variable_02E23Z4FEXZR31MN2QwPHB7JMk83G6bBMft.env.variable_02E23Z4FEXZR31MN2QwPHB7JMk83G6bBMft$",
                              "row": [
                                {
                                  "key": "master_guid",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02DZR645U3UQ93bIjM3qwop9lhkcoTE24Cu.input.source_array[@].guid$"
                                },
                                {
                                  "key": "set_guid",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].guid$"
                                },
                                {
                                  "key": "exclusionType",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].exclusionType$"
                                },
                                {
                                  "key": "fileExtension",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].fileExtension$"
                                },
                                {
                                  "key": "iocGuid",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].iocGuid$"
                                },
                                {
                                  "key": "path",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].path$"
                                },
                                {
                                  "key": "anyDrive",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].anydrive$"
                                },
                                {
                                  "key": "executableName",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].executableName$"
                                },
                                {
                                  "key": "excludeExploitPrevention",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].excludeExploitPrevention$"
                                },
                                {
                                  "key": "fileScanEngine",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].engineSettings_fileScan_applyToEngine$"
                                },
                                {
                                  "key": "fileScanChild",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].engineSettings_fileScan_applyToChildProcesses$"
                                },
                                {
                                  "key": "maliciousEngine",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].engineSettings_maliciousActivity_applyToEngine$"
                                },
                                {
                                  "key": "maliciousChild",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].engineSettings_maliciousActivity_applyToChildProcesses$"
                                },
                                {
                                  "key": "behavioralEngine",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].engineSettings_behavioralProtection_applyToEngine$"
                                },
                                {
                                  "key": "behavioralChild",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].engineSettings_behavioralProtection_applyToChildProcesses$"
                                },
                                {
                                  "key": "systemEngine",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].engineSettings_systemProcessProtection_applyToEngine$"
                                },
                                {
                                  "key": "systemChild",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].engineSettings_systemProcessProtection_applyToChildProcesses$"
                                },
                                {
                                  "key": "processPath",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].process_path$"
                                },
                                {
                                  "key": "processSHA",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].process_sha$"
                                },
                                {
                                  "key": "processUser",
                                  "type": "string",
                                  "value": "$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].process_user$"
                                }
                              ],
                              "rows": {
                                "rows_matching_criteria": true,
                                "where_clause": "set_guid == '$activity.definition_activity_02E07RTHA1SGA4Yz4EkxQrfZ4hTzg337aBo.input.source_array[@].guid$' AND master_guid == '$activity.definition_activity_02DZR645U3UQ93bIjM3qwop9lhkcoTE24Cu.input.source_array[@].guid$'"
                              },
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "categories": [
      "category_023LORSSPJ2KG63dNX47PVlKn7caGzkB7UP"
    ]
  },
  "targets": {
    "definition_target_01OLZWAJLAZB66FxVX2zRLTqQqMVxgmnri5": {
      "unique_name": "definition_target_01OLZWAJLAZB66FxVX2zRLTqQqMVxgmnri5",
      "name": "CTR_For_Access_Token",
      "title": "CTR_For_Access_Token",
      "type": "web-service.endpoint",
      "base_type": "target",
      "object_type": "definition_target",
      "properties": {
        "default_runtime_user_id": "definition_runtime_user_021BGNJAERH2963yCQngD62sbCZsKdZ6Ktn",
        "description": "CTR_For_Access_Token",
        "disable_certificate_validation": false,
        "display_name": "CTR_For_Access_Token",
        "host": "visibility.amp.cisco.com",
        "no_runtime_user": false,
        "path": "/iroh",
        "protocol": "https"
      }
    },
    "definition_target_02DDG6868VHDM2usFCivxpeXr1QlQmHBm5N": {
      "unique_name": "definition_target_02DDG6868VHDM2usFCivxpeXr1QlQmHBm5N",
      "name": "Secure_Endpoint_V3",
      "title": "Secure_Endpoint_V3",
      "type": "web-service.endpoint",
      "base_type": "target",
      "object_type": "definition_target",
      "properties": {
        "description": "",
        "disable_certificate_validation": false,
        "display_name": "Secure_Endpoint_V3",
        "host": "api.amp.cisco.com",
        "ignore_proxy": false,
        "no_runtime_user": true,
        "path": "/v3",
        "port": 443,
        "protocol": "https"
      }
    }
  },
  "runtime_users": {
    "definition_runtime_user_021BGNJAERH2963yCQngD62sbCZsKdZ6Ktn": {
      "unique_name": "definition_runtime_user_021BGNJAERH2963yCQngD62sbCZsKdZ6Ktn",
      "name": "CTR_Credentials",
      "title": "CTR_Credentials",
      "type": "runtime_user.oauth_integration",
      "base_type": "runtime_user",
      "object_type": "definition_runtime_user",
      "properties": {
        "display_name": "CTR_Credentials"
      }
    }
  },
  "target_groups": {
    "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH": {
      "unique_name": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
      "name": "Default TargetGroup",
      "title": "Default TargetGroup",
      "type": "generic.target_group",
      "base_type": "target_group",
      "version": "1.0.0",
      "targets": [
        {
          "data_target_type": "web-service.endpoint",
          "view_target_type": "web-service.endpoint",
          "include_all_targets": true
        },
        {
          "data_target_type": "email.smtp_endpoint",
          "view_target_type": "email.smtp_endpoint",
          "include_all_targets": true
        }
      ],
      "object_type": "target_group"
    }
  },
  "variables": {
    "variable_02DE6YRNRBCB57XL51FTUqGVHFbAorx2SWA": {
      "unique_name": "variable_02DE6YRNRBCB57XL51FTUqGVHFbAorx2SWA",
      "properties": {
        "value": "0",
        "scope": "env",
        "name": "Secure_Endpoint_OrgID",
        "type": "datatype.string",
        "is_required": false,
        "display_on_wizard": false,
        "is_invisible": false
      },
      "object_type": "variable"
    },
    "variable_02E23Z4FEXZR31MN2QwPHB7JMk83G6bBMft": {
      "unique_name": "variable_02E23Z4FEXZR31MN2QwPHB7JMk83G6bBMft",
      "schema_id": "tabletype_02E23YF9E71S96IHwI1aSv7LsDVZb6rDjnE",
      "properties": {
        "scope": "env",
        "name": "CiscoSecureEndpoint_Exclusion_Table",
        "type": "datatype.table",
        "is_required": false,
        "display_on_wizard": false,
        "is_invisible": false
      },
      "object_type": "variable"
    }
  },
  "table_types": {
    "tabletype_02DZNZVP7M8KI2uGj5wflJ6S6vkhaO4N51c": {
      "unique_name": "tabletype_02DZNZVP7M8KI2uGj5wflJ6S6vkhaO4N51c",
      "data_type": "datatype.tabletype",
      "display_name": "Exclusion_set_table",
      "columns": [
        {
          "name": "name",
          "title": "name",
          "type": "string"
        },
        {
          "name": "operatingsystem",
          "title": "operatingsystem",
          "type": "string"
        },
        {
          "name": "guid",
          "title": "guid",
          "type": "string"
        }
      ],
      "base_type": "datatype",
      "object_type": "tabletype"
    },
    "tabletype_02E23YF9E71S96IHwI1aSv7LsDVZb6rDjnE": {
      "unique_name": "tabletype_02E23YF9E71S96IHwI1aSv7LsDVZb6rDjnE",
      "data_type": "datatype.tabletype",
      "display_name": "CiscoSecureEndpoint_Exclusion_Table",
      "columns": [
        {
          "name": "master_guid",
          "title": "master_guid",
          "type": "string"
        },
        {
          "name": "processSHA",
          "title": "processSHA",
          "type": "string"
        },
        {
          "name": "set_guid",
          "title": "set_guid",
          "type": "string"
        },
        {
          "name": "path",
          "title": "path",
          "type": "string"
        },
        {
          "name": "systemChild",
          "title": "systemChild",
          "type": "string"
        },
        {
          "name": "maliciousEngine",
          "title": "maliciousEngine",
          "type": "string"
        },
        {
          "name": "behavioralChild",
          "title": "behavioralChild",
          "type": "string"
        },
        {
          "name": "fileExtension",
          "title": "fileExtension",
          "type": "string"
        },
        {
          "name": "iocGuid",
          "title": "iocGuid",
          "type": "string"
        },
        {
          "name": "processUser",
          "title": "processUser",
          "type": "string"
        },
        {
          "name": "maliciousChild",
          "title": "maliciousChild",
          "type": "string"
        },
        {
          "name": "behavioralEngine",
          "title": "behavioralEngine",
          "type": "string"
        },
        {
          "name": "exclusionType",
          "title": "exclusionType",
          "type": "string"
        },
        {
          "name": "systemEngine",
          "title": "systemEngine",
          "type": "string"
        },
        {
          "name": "fileScanEngine",
          "title": "fileScanEngine",
          "type": "string"
        },
        {
          "name": "fileScanChild",
          "title": "fileScanChild",
          "type": "string"
        },
        {
          "name": "executableName",
          "title": "executableName",
          "type": "string"
        },
        {
          "name": "anyDrive",
          "title": "anyDrive",
          "type": "string"
        },
        {
          "name": "processPath",
          "title": "processPath",
          "type": "string"
        },
        {
          "name": "excludeExploitPrevention",
          "title": "excludeExploitPrevention",
          "type": "string"
        }
      ],
      "base_type": "datatype",
      "object_type": "tabletype"
    }
  },
  "atomic_workflows": [
    "definition_workflow_02DDIR6ATE1L579banVg6VWl8rgQDCX8ErV"
  ],
  "dependent_workflows": [
    "definition_workflow_02DDIR6ATE1L579banVg6VWl8rgQDCX8ErV"
  ]
}
